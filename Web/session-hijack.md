# 세션 하이잭이란?

- 세션은 서로 다른 두 컴퓨터 간의 연결이 활성화된 상태를 말하는데, 이 연결을 가로채는 것을 세션 하이잭이라고 한다.

<br>

## `TCP 세션 하이재킹`

- TCP의 고유한 취약점을 이용해 정상적인 접속을 빼앗는 방법이다.
- TCP는 클라이언트-서버간 통신을 할 때 패킷의 연속성을 보장하기 위해 각각 `시퀀스 넘버`를 사용하는데, 이 시퀀스 넘버가 잘못되면 이를 바로잡기 위한 작업을 한다.
- 이때 공격자는 서버, 클라이언트에 각각 잘못된 시퀀스 넘버를 위조해서 연결된 세션에 혼란을 준 뒤 끼어들어가는 방식이다.

## `HTTP 세션 하이재킹`

- 일반적으로 웹서비스는 인증이 완료된 `사용자 식별정보(이하 세션ID)`를 세션과 쿠키를 이용하여 저장해두고 웹페이지의 요청자를 구별한다.
- 웹 브라우저가 세션ID를 포함해 요청할 때 서버는 갖고있는 세션ID와 요청에 포함된 세션ID를 비교해 접근 권한을 판단한다.
- 서버는 동일한 세션ID를 가진 요청을 동일 접근 권한을 가진것으로 처리하는데, 이 세션ID를 `스니핑`이나 `무작위 추측공격`을 통해서 탈취하는 방식이다.
  - 스니핑(Sniffing): 네트워크 상의 패킷 또는 통신할 때 세션ID를 탈취하는 방식
  - 무작위 추측공격: 세션ID를 무작위로 생성해 대입하며 탈취하는 방식

<br>

## `대응방안`

1. 암호화된 통신

- HTTPS를 사용해 통신데이터를 암호화 한다.

2. 세션관리

- 쿠키나 세션에 저장되는 데이터를 예측할 수 없도록 생성, 관리한다.

3. 세션 타임아웃

- 세션 타임아웃을 설정해 탈취된 세션의 유효시간을 짧게 설정한다.

4. CSRF방지

- CSRF토큰을 사용해 요청 헤더나 파라미터에 포함시켜 서버에서 해당 요청이 정상적인 요청인지 판단하게 한다.

5. 세션ID 생성관리

- 동일한 세션ID가 재사용되지 않도록, 매 로그인마다 새로운 세션ID가 생성되도록 한다.
- 무작위 추측공겨에 대비하여 일정 횟수 이상 인증실패할 경우 사용자 잠금 기능을 구현한다.

<br>

# Reference

[세션 (컴퓨터 과학)](<https://ko.wikipedia.org/wiki/%EC%84%B8%EC%85%98_(%EC%BB%B4%ED%93%A8%ED%84%B0_%EA%B3%BC%ED%95%99)>)

[Session_hijacking](https://en.wikipedia.org/wiki/Session_hijacking)
